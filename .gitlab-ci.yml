stages:
  - build
  - unit-tests
  - end-to-end-tests
  - deploy

variables:
  HTTP_PORT: 8080
  HTTPS_PORT: 8081
  DOMAIN: ""
  MYSQL_USER: user
  MYSQL_PASSWORD: password
  MYSQL_ROOT_PASSWORD: rootpassword
  MYSQL_DATABASE: kanclOnline

build:
  stage: build
  image: jansimonek/caddy-maria-maven:0.1.2
  before_script:
    - rm /etc/caddy/Caddyfile && cp run/Caddyfile /etc/caddy/Caddyfile
    - caddy reload
  script:
    - mvn package

unit-tests:
  stage: unit-tests
  script:
    - mvn test

end-to-end-tests:
  stage: end-to-end-tests
  script:
    - echo "This job tests something, but takes more time than test-job1."
    - echo "After the echo commands complete, it runs the sleep command for 20 seconds"
    - echo "which simulates a test that runs 20 seconds longer than test-job1"
    - sleep 10

deploy:
  stage: deploy
  script:
    - echo "This job deploys something from the $CI_COMMIT_BRANCH branch."